<h2 ng-show="showRepo" id="page-anchor-commits">Commits</h2>
<div class="row" ng-show="showRepo">
	<div class="col-md-4 form-inline">
		<div class="form-group">
			<input type="text" class="form-control" ng-model="search.fulltext" placeholder="Filter commits">
		</div>
		<div class="checkbox">
			<label><input type="checkbox" class="form-control" ng-model="search.merge" /> Show Merge commits?</label>
		</div>
	</div>
	<div class="col-md-8">
		<div class="pull-right">
			<div class="form-group">
				<button class="btn btn-default" ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">Previous</button>
				{{currentPage+1}}/{{numberOfPages()}}
				<button class="btn btn-default" ng-disabled="currentPage >= commits.length/pageSize - 1" ng-click="currentPage=currentPage+1">Next</button>
			</div>
		</div>
	</div>
</div>
<div class="row" ng-show="showRepo">
	<div class="col-md-12">
		
		<div ng-repeat="commit in commits | startFrom:currentPage*pageSize | limitTo:pageSize">
			<div class="panel panel-default" ng-class="{'panel-danger':commit.contains_bug}">
				<div class="panel-heading">
					<div class="pull-right">{{commit.author_name}} on {{commit.author_date}}</div>
					<h3 class="panel-title">
						<span ng-show="commit.classification != 'None'" class="label label-default">{{commit.classification}}</span> <span ng-if="commit.contains_bug">Possible Bug-inducing: </span>{{commit.commit_hash.substr(0, 10)}} <em>{{commit.commit_message.substr(0, 60)}}...</em>
					</h3>
				</div>
				<div class="panel-body">
					<div class="row">
						<div class="col-md-4">
							<div class="row">
								<div class="col-md-6">
									<div metric-summary="commit.metric_summary">
									</div>
								</div>
								<div class="col-md-6">
									<div class="list-group metric-summary-legend" ng-init="mtotal = commit.metric_summary.below + commit.metric_summary.between + commit.metric_summary.above">
										<a class="list-group-item list-group-item-primary" href="#" ng-click="ms_filter = false">
											All Categories
										</a>
										<a class="list-group-item list-group-item-danger" href="#" ng-click="ms_filter = 1" ng-class="{'active':ms_filter === 1}">
											{{commit.metric_summary.above | percentof: mtotal}}% High Risk
										</a>
										<a class="list-group-item list-group-item-warning" href="#" ng-click="ms_filter = 0" ng-class="{'active':ms_filter === 0}">
											{{commit.metric_summary.between | percentof: mtotal}}% Possible Risk
										</a>
										<a class="list-group-item list-group-item-success" href="#" ng-click="ms_filter = -1" ng-class="{'active':ms_filter === -1}">
											{{commit.metric_summary.below | percentof: mtotal}}% Low Risk
										</a>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="well cont-max-150" ng-bind="commit.commit_message"></div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12 cont-max-150">
									Updated Files:
									<span class="label label-primary label-inline" ng-repeat="file in commit.fileschanged">{{file}}</span>
								</div>
							</div>
						</div>
						<div class="col-md-8">
							<div class="row">
								<div ng-repeat="(key, display) in metricValues" ng-if="(ms_filter===false || (!ms_filter && ms_filter !== 0))?true:(commit[key].threshold == ms_filter)" class="inline-col col-md-2" metric="commit[key]">{{display}}</div>
							</div>
						</div>
					</div>
					<form ng-show="user.status.authenticated" class="form-inline pull-right" name="commit.feedback" ng-submit="submitFeedback(commit)">
						<div ng-show="show_commit_feedback"> 
							<div class="form-group">	
								<input type="text" class="form-control" ng-model="commit.feedback.comment" placeholder="Was this helpful?">
							</div>
							<div class="form-group">
								<div class="btn-group">
									<input type="hidden" class="form-control" required ng-model="commit.feedback.score">
									<button type="button" class="btn btn-default" ng-click="commit.feedback.score = 1" ng-class="{'btn-success':commit.feedback.score > 0}"><i class="fa fa-thumbs-up"></i></button>
									<button type="button" class="btn btn-default" ng-click="commit.feedback.score = -1" ng-class="{'btn-danger':commit.feedback.score < 0}"><i class="fa fa-thumbs-down"></i></button>
								</div>
							</div>
						
							<div class="form-group">	
								<button class="btn btn-primary" type="submit" ng-disabled="commit.feedback.$invalid">Submit Feedback</button>
							</div>
						</div>
						<div class="form-group" ng-show="!show_commit_feedback">
							<button class="btn btn-primary" type="button" ng-click="show_commit_feedback = !show_commit_feedback">Feedback?</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		<div ng-if="commits.length == 0">
			<div class="alert alert-main alert-warning">No Results</div>
		</div>
	</div>
</div>